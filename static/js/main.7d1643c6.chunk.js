(this["webpackJsonpconnect-client"]=this["webpackJsonpconnect-client"]||[]).push([[0],{317:function(e,t,a){},532:function(e,t,a){e.exports=a(896)},537:function(e,t,a){},542:function(e,t,a){},573:function(e,t){},613:function(e,t,a){},701:function(e,t){},703:function(e,t){},742:function(e,t){},743:function(e,t){},895:function(e,t,a){},896:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(50),i=a.n(c),l=a(13),o=a.n(l),s=a(32),u=a(30),d=(a(537),a(126)),m=a(44),f=a(902),p=a(922),b=a(210),h=a(919),E=a(911),v=a(910),g=a(915),y=a(234),O=a(76);function j(){return(j=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function w(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},c=Object.keys(e);for(n=0;n<c.length;n++)a=c[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(n=0;n<c.length;n++)a=c[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var k=r.a.createElement("defs",null,r.a.createElement("style",null,".cls-1,.cls-2{fill:#0073eb;stroke:#fff;stroke-miterlimit:10;stroke-width:3px;}.cls-2{opacity:0.7;}.cls-3{fill:#1a1a1a;}")),C=r.a.createElement("path",{className:"cls-1",d:"M111.83,48.88h0l-8.38,20.22L98.27,81.58l0,0v.08L91.48,98h0L90,101.55h0l-2.9,7-.6-2.23-.64-2.43-4-15.27L71,47.66l-1.6-6.1L63.79,20.1Z"}),x=r.a.createElement("polygon",{className:"cls-2",points:"87.09 108.56 85.99 107.12 84.4 105.05 77.65 96.2 71.96 88.74 50.31 60.32 41.21 48.39 71.04 47.66 81.83 88.63 85.85 103.9 86.49 106.33 87.09 108.56"}),S=r.a.createElement("polygon",{className:"cls-1",points:"67.95 154.72 59.71 174.61 29.58 171.5 58.55 149.76 64.48 145.32 75.17 137.31 67.96 154.69 67.95 154.72"}),I=r.a.createElement("path",{className:"cls-1",d:"M134.41,137.69h0L81.75,151.16l-2.83.73-11,2.8,7.21-17.38h0l2.27-5.48h0l9.54-23,.1-.23h0l2.9-7h0L91.47,98h0l6.75-16.29h0l0-.09,5.17-12.47,8.38-20.22h0l4,15.53,4.51,17.78,4.95,19.43,3,11.89h0Z"}),T=r.a.createElement("polygon",{className:"cls-1",points:"161.52 72.3 156.34 84.79 151.4 96.73 147.81 105.36 146.74 107.93 146.74 107.94 134.41 137.69 128.27 113.52 128.26 113.52 125.24 101.63 120.29 82.2 120.3 82.19 121.87 81.82 141.5 77.1 160.2 72.62 161.52 72.3"}),N=r.a.createElement("polygon",{className:"cls-2",points:"187.8 89.91 179.44 91.47 170.42 93.17 170.41 93.16 151.4 96.73 156.34 84.79 161.52 72.3 162.14 72.71 187.8 89.91"}),D=r.a.createElement("path",{className:"cls-3",d:"M234.77,211.91h-17.2L209.18,190H163l-8.4,21.88H137.37l38.93-98.23h19.54Zm-66-36.73H203.4l-17.33-45.27Z"}),A=r.a.createElement("path",{className:"cls-3",d:"M259.67,211.91H245V161.28h-5.64V148.07h11.83l6.19,6.2c5.5-4.54,12.24-7.43,18.57-7.43a20.61,20.61,0,0,1,17.34,8.66,31.53,31.53,0,0,1,21-8.66c11.7,0,22.43,8,22.43,26.55v38.52H322V173.39c0-8.39-4.54-12.93-11.28-12.93-7.57,0-12.52,4.54-12.52,10.59v40.86H283.61V173.39c0-8.39-4.68-12.93-11.29-12.93-7.42,0-12.65,4.4-12.65,10.18Z"}),M=r.a.createElement("path",{className:"cls-3",d:"M393.53,190.72l12.1,6.61c-4.95,8.39-14.17,16.09-26.82,16.09-18.3,0-31.37-15.41-31.37-33.29s13.07-33.57,31.23-33.57,29.44,15.27,30,31.92l-5.5,5.36H362.3c.82,9.5,8.11,15.82,16.51,15.82C384.58,199.66,390.36,196,393.53,190.72ZM363,172.15h30.95c-1-7.15-7.43-12.52-15.27-12.52A15.72,15.72,0,0,0,363,172.15Z"}),H=r.a.createElement("path",{className:"cls-3",d:"M461.76,190.72l12.11,6.61c-4.95,8.39-14.17,16.09-26.83,16.09-18.3,0-31.37-15.41-31.37-33.29s13.07-33.57,31.23-33.57,29.44,15.27,30,31.92l-5.5,5.36H430.53c.83,9.5,8.12,15.82,16.51,15.82C452.82,199.66,458.6,196,461.76,190.72Zm-30.54-18.57h30.95c-1-7.15-7.42-12.52-15.27-12.52A15.72,15.72,0,0,0,431.22,172.15Z"}),R=r.a.createElement("path",{className:"cls-3",d:"M489.41,113.68l4.82-5h10.18V197.6h5.64v14.31H495.6l-6.19-6.33Z"}),P=r.a.createElement("path",{className:"cls-3",d:"M540.73,211.91H526V161.28h-5.5V148.07h15l5.23,5.23ZM532,112a10.49,10.49,0,0,1,10.39,10.39A10.37,10.37,0,0,1,532,132.67a10.25,10.25,0,0,1-10.25-10.26A10.37,10.37,0,0,1,532,112Z"}),L=r.a.createElement("path",{className:"cls-3",d:"M620,180a33.36,33.36,0,1,1-33.29-33.29A33.35,33.35,0,0,1,620,180Zm-15,0c0-10.32-7.71-19.12-18.3-19.12s-18.44,8.8-18.44,19.12,7.85,19.26,18.44,19.26S605,190.31,605,180Z"}),B=function(e){var t=e.svgRef,a=e.title,n=w(e,["svgRef","title"]);return r.a.createElement("svg",j({id:"Golden_Grid","data-name":"Golden Grid",viewBox:"0 0 666.85 257.93",ref:t},n),a?r.a.createElement("title",null,a):null,k,C,x,S,I,T,N,D,A,M,H,R,P,L)},F=r.a.forwardRef((function(e,t){return r.a.createElement(B,j({svgRef:t},e))})),q=(a.p,a(542),a(17)),V=a(82),z=a(38),U=a(85),_=a.n(U),G=Object(z.c)(),W=Object(z.b)("staff/fetchStaff",Object(s.a)(o.a.mark((function e(){var t,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,kr("/admins");case 2:if(200===(t=e.sent).status&&t.data){e.next=5;break}throw t;case 5:return a=t.data.admins.map((function(e){return _()(e)})),e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})))),Z=Object(z.b)("staff/updateStaff",function(){var e=Object(s.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,kr("/admin",{method:"POST",body:JSON.stringify({user_id:t.userId,permissions:t.permissions})});case 2:if(200===e.sent.status){e.next=5;break}throw new Error("Failed to update staff member information");case 5:return e.abrupt("return",{userId:t.userId,changes:{permissions:t.permissions}});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),J=Object(z.b)("staff/createStaff",function(){var e=Object(s.a)(o.a.mark((function e(t){var a,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,kr("/admin",{method:"POST",body:JSON.stringify({email:t.email,role:t.role,permissions:t.permissions})});case 2:return a=e.sent,n=_()(a.data.staff),e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),K=G.getInitialState({loading:!1}),Q=Object(z.d)({name:"staff",initialState:K,reducers:{staffSetAll:G.setAll,staffUpdateOne:G.updateOne},extraReducers:function(e){e.addCase(W.fulfilled,(function(e,t){return G.addMany(e,t.payload)})),e.addCase(W.rejected,(function(e,t){return Object(q.a)(Object(q.a)({},e),{},{error:t.error.message})})),e.addCase(Z.fulfilled,(function(e,t){return G.updateOne(e,{id:t.payload.userId,changes:t.payload.changes})})),e.addCase(Z.rejected,(function(e,t){return Object(q.a)(Object(q.a)({},e),{},{error:t.error.message})})),e.addCase(J.fulfilled,(function(e,t){return G.addOne(e,t.payload)})),e.addCase(J.rejected,(function(e,t){return Object(q.a)(Object(q.a)({},e),{},{error:t.error.message})}))}}),Y=(Q.actions,Object(z.b)("inmate/fetchInmates",Object(s.a)(o.a.mark((function e(){var t,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,kr("/inmates",{},!1);case 2:if(200===(t=e.sent).status&&t.data){e.next=5;break}throw t;case 5:return a=t.data.inmates.map((function(e){return _()(e)})),e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)}))))),$=Object(z.b)("inmate/updateInmate",function(){var e=Object(s.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,kr("/inmate/".concat(t.id),{method:"PUT",body:JSON.stringify({inmate_number:t.inmateNumber,first_name:t.firstName,last_name:t.lastName,location:t.location})},!1);case 2:return e.abrupt("return",{inmateId:t.id,changes:{inmateNumber:t.inmateNumber,firstName:t.firstName,lastName:t.lastName,location:t.location}});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),X=Object(z.c)(),ee=Object(z.d)({name:"inmates",initialState:X.getInitialState(),reducers:{inmatesAddMany:X.addMany,inmatesUpdate:X.updateOne},extraReducers:function(e){e.addCase(Y.fulfilled,(function(e,t){return X.setAll(e,t.payload)})),e.addCase(Y.rejected,(function(e,t){return console.log("error")})),e.addCase($.fulfilled,(function(e,t){return X.updateOne(e,{id:t.payload.inmateId,changes:t.payload.changes})})),e.addCase($.rejected,(function(e,t){return Object(q.a)(Object(q.a)({},e),{},{error:t.error.message})}))}}),te=(ee.actions,a(171)),ae={padding:24},ne={borderRadius:6},re={width:"100%"},ce=["#eef6ff","#9ac1ec","#70a9e9","#0275D8","#004886"],ie=a(485),le=a.n(ie),oe=a(155),se=a(486),ue=a(272),de=a(898),me=a(899),fe=a(900),pe=a(908),be=a(110),he=a.n(be),Ee=a(304),ve=function(e){var t=new Date;return t.setHours(e.start.hour),t.setMinutes(e.start.minute),t.toString()},ge=function(e){var t=new Date;return t.setHours(e.start.hour),t.setMinutes(e.start.minute),Object(ue.a)(t,e.duration).toString()};function ye(e){var t=e.getDay();return e.setDate(e.getDate()-t+1),e.setHours(0,0,0,0),e}var Oe=function(e,t,a){return e.filter((function(e){return new Date(e.scheduledEndTime)>=t&&new Date(e.scheduledEndTime)<=a}))},je=function(e){var t=new Date;t.setHours(0,0,0,0);var a=new Date;return a.setHours(23,59,59,59),Oe(e,t,a)},we=(a(901),a(921),function(e){return e?"".concat(e.firstName," ").concat(e.lastName):""}),ke=function(e){return JSON.parse(JSON.stringify(e))};function Ce(e,t,a){return a.indexOf(e)===t}var xe=function(e){var t,a,n,r,c=[["approved",(null===(t=e.approved)||void 0===t?void 0:t.toString())||"true"],["limit",(null===(a=e.limit)||void 0===a?void 0:a.toString())||"100"],["offset",(null===(n=e.offset)||void 0===n?void 0:n.toString())||"0"]];return e.firstLive&&c.push(["first_live",e.firstLive]),e.end&&c.push(["end",e.end]),e.startDate&&e.endDate&&c.push(["start","".concat(e.startDate,",").concat(e.endDate)]),e.minDuration&&e.maxDuration&&c.push(["duration","".concat(e.minDuration,", ").concat(e.maxDuration)]),(null===(r=e.query)||void 0===r?void 0:r.length)&&c.push(["global",e.query]),function(e){return e.map((function(e){return e[0]+"="+encodeURIComponent(e[1])})).join("&")}(c)};function Se(e){var t=["#093145","#3C6478","#107896","#43ABC9","#C2571A","#9A2617"];return t[Math.abs(function(e){for(var t=0,a=0;a<e.length;a++)t=e.charCodeAt(a)+((t<<6)-t);return t}(e)%t.length)]}function Ie(e){return null!==e&&void 0!==e}var Te=a(526),Ne=a(523),De=function(e,t,a){Te.a[a]({message:e,description:t})},Ae=function(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3;switch(a){case"success":Ne.b.success({content:t,key:e,duration:n});break;case"error":Ne.b.error({content:t,key:e,duration:n});break;case"warning":Ne.b.warning({content:t,key:e,duration:n});break;case"loading":Ne.b.loading({content:t,key:e,duration:n});break;default:Ne.b.info({content:t,key:e,duration:n})}},Me=Object(z.b)("connection/updateConnection",function(){var e=Object(s.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,kr("/connection",{method:"PUT",body:JSON.stringify({connection_id:t.connectionId,status:t.status})});case 2:if(200===(a=e.sent).status){e.next=5;break}throw a;case 5:return e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),He=Object(z.b)("connection/fetchConnections",Object(s.a)(o.a.mark((function e(){var t,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,kr("/connections");case 2:if(200===(t=e.sent).status&&t.data){e.next=5;break}throw t;case 5:return a=t.data.connections.map((function(e){return _()(e)})),console.log(a),e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})))),Re=Object(z.c)(),Pe=Object(z.d)({name:"connections",initialState:Re.getInitialState(),reducers:{connectionsAddOne:Re.addOne,connectionsAddMany:Re.addMany,connectionsUpdate:Re.updateOne},extraReducers:function(e){e.addCase(He.fulfilled,(function(e,t){return Re.addMany(e,t.payload)})),e.addCase(He.rejected,(function(e,t){return console.log(t.error)})),e.addCase(Me.fulfilled,(function(e,t){var a=t.payload,n=a.status,r=a.connectionId;switch(n){case"approved":De("Connection created!","Hooray!","success");break;case"denied":De("Connection rejected","Very sad","info")}Re.updateOne(e,{id:r,changes:{status:n}})})),e.addCase(Me.rejected,(function(e,t){return console.log(t.error)}))}}),Le=(Pe.actions,Object(z.b)("contact/fetchContacts",Object(s.a)(o.a.mark((function e(){var t,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,kr("/users");case 2:if(200===(t=e.sent).status&&t.data){e.next=5;break}throw t;case 5:return a=t.data.users.map((function(e){return _()(e)})),e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)}))))),Be=Object(z.c)(),Fe=Object(z.d)({name:"inmates",initialState:Be.getInitialState(),reducers:{contactsAddMany:Be.addMany},extraReducers:function(e){e.addCase(Le.fulfilled,(function(e,t){return Be.setAll(e,t.payload)})),e.addCase(Le.rejected,(function(e,t){return console.log("error")}))}});Fe.actions;function qe(e){var t=e.messages.map((function(e){return{content:e.contents,from:e.fromType,timestamp:e.createdAt}}));return{id:e.id,connectionId:e.connection_id,scheduledStartTime:e.start,scheduledEndTime:e.end,end:e.end,approved:e.approved,kioskId:e.kiosk_id,videoReady:e.video_ready,status:e.status,rating:e.rating,requesterId:e.requester_id,inmateId:e.inmate_id,messages:t}}var Ve=Object(z.c)(),ze=Object(z.b)("calls/fetchAll",function(){var e=Object(s.a)(o.a.mark((function e(t){var a,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,kr("/calls?".concat(xe(t)));case 2:if(200===(a=e.sent).status){e.next=5;break}throw a;case 5:return n=a.data.calls.map(qe),e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Ue=Object(z.b)("/call/fetchRecording",function(){var e=Object(s.a)(o.a.mark((function e(t){var a,n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,kr("/call/".concat(t));case 2:if(200===(a=e.sent).status){e.next=5;break}throw a;case 5:return n=a.data.url,r=a.data.messages,e.abrupt("return",{callId:t,recordingUrl:n,messages:r});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),_e=Ve.getInitialState({}),Ge=Object(z.d)({name:"calls",initialState:_e,reducers:{callsAddMany:Ve.addMany,callsSetAll:Ve.setAll,addMessage:function(e,t){var a=t.payload,n=a.id,r=a.message,c=e.entities[n];c&&Ve.updateOne(e,{id:n,changes:{messages:[].concat(Object(oe.a)(c.messages),[r])}})}},extraReducers:function(e){e.addCase(ze.fulfilled,(function(e,t){Ve.upsertMany(e,t.payload)})),e.addCase(ze.rejected,(function(e,t){return Object(q.a)(Object(q.a)({},e),{},{error:t.error.message})})),e.addCase(Ue.fulfilled,(function(e,t){return Ve.updateOne(e,{id:t.payload.callId,changes:{recordingUrl:t.payload.recordingUrl,messages:t.payload.messages}})})),e.addCase(Ue.rejected,(function(e,t){return Object(q.a)(Object(q.a)({},e),{},{error:t.error.message})}))}}),We=Ge.actions,Ze=Object(z.c)(),Je=Object(z.b)("facility/selectActiveFacility",function(){var e=Object(s.a)(o.a.mark((function e(t){var a,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,kr("/node/".concat(t.nodeId,"/times"),{},!1);case 2:if((a=e.sent).data){e.next=5;break}throw new Error("Could not load facility data");case 5:return n=_()(a.data.call_times),e.abrupt("return",Object(q.a)(Object(q.a)({},t),{},{callTimes:n}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Ke=Object(z.b)("facility/fetchFacilities",Object(s.a)(o.a.mark((function e(){var t,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,kr("/user/".concat(Or.getState().session.user.id,"/facilities"),{},!1);case 2:if((t=e.sent).data){e.next=5;break}throw new Error("Could not load list of facilities");case 5:if((a=_()(t.data)).length){e.next=8;break}throw new Error("Must have access to at least one facility");case 8:return Or.dispatch(Je(a[0])),e.abrupt("return",{facilities:a});case 10:case"end":return e.stop()}}),e)})))),Qe=Object(z.b)("facility/updateCallTimes",function(){var e=Object(s.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,kr("/times",{method:"PUT",body:JSON.stringify({call_times:t.callSlots,zone:"America_LosAngeles"})});case 2:if(e.sent.data){e.next=5;break}throw new Error("Could not update call time");case 5:return e.abrupt("return",t.callSlots);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Ye=Ze.getInitialState({loading:!1}),$e=Object(z.d)({name:"facilities",initialState:Ye,reducers:{},extraReducers:function(e){e.addCase(Ke.fulfilled,(function(e,t){return Ze.setAll(e,t.payload.facilities)})),e.addCase(Ke.rejected,(function(e,t){return Object(q.a)(Object(q.a)({},e),{},{error:t.error.message})})),e.addCase(Je.fulfilled,(function(e,t){return Object(q.a)(Object(q.a)({},e),{},{selected:t.payload,loading:!1})})),e.addCase(Je.rejected,(function(e,t){return Object(q.a)(Object(q.a)({},e),{},{error:t.error.message,loading:!1})})),e.addCase(Je.pending,(function(e){return Object(q.a)(Object(q.a)({},e),{},{loading:!0})})),e.addCase(Qe.pending,(function(e,t){Ae("facility/updateCallTimes","Processing request...","loading")})),e.addCase(Qe.fulfilled,(function(e,t){return Ae("facility/updateCallTimes","Succesfully updated the settings!","success"),e.selected?Object(q.a)(Object(q.a)({},e),{},{selected:Object(q.a)(Object(q.a)({},e.selected),{},{callTimes:t.payload})}):Object(q.a)({},e)})),e.addCase(Qe.rejected,(function(e,t){Ae("facility/updateCallTimes","Failed to update.","success")}))}}),Xe=($e.actions,Object(z.b)("node/fetchNodes",Object(s.a)(o.a.mark((function e(){var t,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,kr("/subnodes");case 2:if(200===(t=e.sent).status){e.next=5;break}throw t;case 5:return a=t.data.subnodes,e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)}))))),et=Object(z.c)(),tt=Object(z.d)({name:"nodes",initialState:et.getInitialState(),reducers:{inmatesAddMany:et.addMany,inmatesUpdate:et.updateOne},extraReducers:function(e){e.addCase(Xe.fulfilled,(function(e,t){return et.setAll(e,t.payload)})),e.addCase(Xe.rejected,(function(e,t){return Ae("nodes","Could not load facility information","error")}))}}),at=(tt.actions,Object(z.c)()),nt=Object(z.b)("kiosk/fetchKiosks",Object(s.a)(o.a.mark((function e(){var t,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,kr("/kiosks");case 2:if((t=e.sent).data){e.next=5;break}throw new Error("Could not load list of facilities");case 5:return a=_()(t.data.kiosks),e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})))),rt=Object(z.d)({name:"kiosks",initialState:at.getInitialState(),reducers:{setSelected:function(e,t){return Object(q.a)(Object(q.a)({},e),{},{selected:t.payload})}},extraReducers:function(e){e.addCase(nt.fulfilled,(function(e,t){return at.setAll(e,t.payload)})),e.addCase(nt.rejected,(function(e,t){return Object(q.a)(Object(q.a)({},e),{},{error:t.error.message})}))}}),ct=Re.getSelectors((function(e){return e.connections})),it=ct.selectById,lt=ct.selectAll,ot=X.getSelectors((function(e){return e.inmates})),st=ot.selectById,ut=ot.selectAll,dt=ot.selectTotal,mt=Be.getSelectors((function(e){return e.contacts})),ft=mt.selectById,pt=(mt.selectAll,Ve.getSelectors((function(e){return e.calls}))),bt=pt.selectById,ht=pt.selectAll,Et=G.getSelectors((function(e){return e.staff})),vt=(Et.selectById,Et.selectAll),gt=Ze.getSelectors((function(e){return e.facilities})),yt=(gt.selectById,gt.selectAll),Ot=et.getSelectors((function(e){return e.nodes})),jt=(Ot.selectById,Ot.selectAll),wt=at.getSelectors((function(e){return e.kiosks})),kt=wt.selectById,Ct=(wt.selectAll,function(e,t){var a=st(e,t.inmateId),n=ft(e,t.userId);if(a&&n)return Object(q.a)({inmate:a,contact:n},t)}),xt=function(e){return lt(e).filter((function(e){return"pending"===e.status}))},St=function(e,t){return t.map((function(t){return Ct(e,t)})).filter(Ie)},It=function(e,t){var a=it(e,t.connectionId);if(a){var n=kt(e,t.kioskId);if(n){var r=Ct(e,a);if(r)return Object(q.a)(Object(q.a)({},t),{},{connection:r,kiosk:n})}}},Tt=function(e,t){return t.map((function(t){return It(e,t)})).filter(Ie)},Nt=function(e,t){var a=bt(e,t);if(a)return It(e,a)},Dt=function(e){var t=ht(e);return Tt(e,t.filter((function(e){return"missing-monitor"===e.status||"live"===e.status})))},At=function(e,t){if(st(e,t)){var a=lt(e);return St(e,a.filter((function(e){return e.inmateId===t})))}},Mt=function(e,t){if(st(e,t))return ht(e).filter((function(e){return e.inmateId===t}))},Ht=a(519),Rt=a(113),Pt=a(913),Lt=a(233),Bt=a(493),Ft=a(494),qt="audioType",Vt="videoType";window.rc=null,window.consumers=[],window.producers=[];var zt={video:{width:{min:640,ideal:1920},height:{min:400,ideal:1080},encodings:[{rid:"r0",maxBitrate:1e5,scalabilityMode:"S1T3"},{rid:"r1",maxBitrate:3e5,scalabilityMode:"S1T3"},{rid:"r2",maxBitrate:9e5,scalabilityMode:"S1T3"}],codecOptions:{videoGoogleStartBitrate:1e3}}},Ut=function(){function e(t,a,n){Object(Bt.a)(this,e),window.rc=this,this.mediasoupClient=t,this.socket=a,this.callId=n,this.producerTransport=null,this.consumerTransport=null,this.device=null,this.consumers={},this.producers={},this.handlers={consume:[]}}return Object(Ft.a)(e,[{key:"request",value:function(){var e=Object(s.a)(o.a.mark((function e(t,a){var n=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){n.socket.emit(t,a,(function(t){t.error?r(t.error):e(t)}))})));case 1:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"handleTransportConnect",value:function(){var e=Object(s.a)(o.a.mark((function e(t){var a=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){t.on("connect",function(){var n=Object(s.a)(o.a.mark((function n(r,c,i){var l;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return l=r.dtlsParameters,console.log("got connect!"),n.next=4,a.request("establishDtls",{dtlsParameters:l,callId:a.callId,transportId:t.id});case 4:c(),e();case 6:case"end":return n.stop()}}),n)})));return function(e,t,a){return n.apply(this,arguments)}}())})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"init",value:function(){var e=Object(s.a)(o.a.mark((function e(){var t,a,n,r,c=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request("join",{callId:this.callId});case 2:return t=e.sent,a=t.producerTransportInfo,n=t.consumerTransportInfo,r=t.routerRtpCapabilities,e.next=8,this.loadDevice(r);case 8:return this.device=e.sent,a&&(this.producerTransport=this.device.createSendTransport(a),this.handleTransportConnect(this.producerTransport)),this.consumerTransport=this.device.createRecvTransport(n),this.handleTransportConnect(this.consumerTransport),e.next=14,this.request("declareRtpCapabilities",{rtpCapabilities:this.device.rtpCapabilities});case 14:this.request("finishConnecting",{callId:this.callId}),this.producerTransport&&this.producerTransport.on("produce",function(){var e=Object(s.a)(o.a.mark((function e(t,a,n){var r,i,l,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.kind,i=t.rtpParameters,console.log("Sending produce request"),e.next=4,c.request("produce",{callId:c.callId,kind:r,rtpParameters:i});case 4:l=e.sent,s=l.producerId,a({id:s});case 7:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}()),this.socket.on("consume",function(){var e=Object(s.a)(o.a.mark((function e(t){var a,n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.consume(t);case 2:a=e.sent,n=a.consumer,r=a.stream,c.socket.emit("resumeConsumer",{callId:c.callId,consumerId:n.id}),c.handlers.consume.forEach((function(e){return e(t.kind,r,t.user)}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getMediaConstraints",value:function(e,t){return e===qt?{audio:{deviceId:t}}:e===Vt?{video:{width:zt.video.width,height:zt.video.height,deviceId:t}}:void 0}},{key:"produce",value:function(){var e=Object(s.a)(o.a.mark((function e(t){var a,n,r,c,i,l,s=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=s.length>1&&void 0!==s[1]?s[1]:null,n=this.getMediaConstraints(t,a),console.log("Media constraints are",n),e.next=5,navigator.mediaDevices.getUserMedia(n);case 5:return r=e.sent,console.log("Got stream"),c=(t===qt?r.getAudioTracks():r.getVideoTracks())[0],i={track:c},console.log("got track"),t===Vt&&(i.encodings=zt.video.encodings,i.codecOptions=zt.video.codecOptions),console.log("producing with params",i),e.next=14,this.producerTransport.produce(i);case 14:l=e.sent,console.log("produced with id",l.id),window.producers.push(l),this.producers[l.id]=l;case 18:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadDevice",value:function(){var e=Object(s.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new this.mediasoupClient.Device,e.next=3,a.load({routerRtpCapabilities:t});case 3:return e.abrupt("return",a);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"consume",value:function(){var e=Object(s.a)(o.a.mark((function e(t){var a,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.consumerTransport.consume(t);case 2:return a=e.sent,n=new MediaStream,this.consumers[a.id]=a,n.addTrack(a.track),console.log("Successfully created stream."),e.abrupt("return",{consumer:a,stream:n});case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"on",value:function(){var e=Object(s.a)(o.a.mark((function e(t,a){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t in this.handlers||(this.handlers[t]=[]),this.handlers[t].push(a);case 2:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"terminate",value:function(){var e=Object(s.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("sending request to terminate"),e.next=3,this.request("terminate",{callId:this.callId});case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),_t=a(495),Gt=a(497),Wt=(a(317),a(128)),Zt=a(284),Jt=a(914),Kt=a(924),Qt=a(925),Yt=a(926),$t=a(927),Xt=a(928),ea=a(929),ta=a(930),aa=Wt.a.SubMenu;function na(e){var t=e.alerts,a=e.terminateCall,c=e.lockCall,i=e.muteCall,l=e.unmuteCall,o=e.isAudioOn,s=e.openChat,d=e.closeChat,m=e.chatCollapsed,f=e.emitAlert,p=Object(n.useState)(null),b=Object(u.a)(p,2),h=b[0],E=b[1],v=r.a.createElement(Wt.a,null,r.a.createElement(aa,{key:"alert",icon:r.a.createElement(Kt.a,null),title:"Send Alert"},t.map((function(e){return r.a.createElement(Wt.a.Item,{key:e.id,onClick:function(){return E(e)}},e.title)}))),r.a.createElement(Wt.a.Item,{key:"lock",icon:r.a.createElement(Qt.a,null),onClick:function(){return c()}},"Lock"),r.a.createElement(Wt.a.Item,{key:"terminate",icon:r.a.createElement(Yt.a,null),onClick:function(){return a()}},"Terminate Call"),r.a.createElement(Wt.a.Item,{key:"mute",icon:o?r.a.createElement($t.a,null):r.a.createElement(Xt.a,null),onClick:function(){return o?i():l()}},o?"Mute":"Unmute"),r.a.createElement(Wt.a.Item,{key:"chat",icon:r.a.createElement(ea.a,null),onClick:function(){return m?s():d()}},m?"View Chat":"Close Chat"));return r.a.createElement("div",{className:"video-commands-overlay"},r.a.createElement(Zt.a,{overlay:v},r.a.createElement(O.a,null,r.a.createElement(ta.a,null))),r.a.createElement(Jt.a,{title:"Are you sure you want to send this alert?",visible:!!h,onOk:function(){h&&f(h),E(null)},onCancel:function(){return E(null)}},r.a.createElement("p",null,"Send the following alert to the participants:"),r.a.createElement("p",null,null===h||void 0===h?void 0:h.body)))}function ra(){return r.a.createElement("div",{className:"video-loading-spinner"},r.a.createElement(Gt.a,{tip:"Loading video call..."}))}var ca=r.a.memo((function(e){var t=e.callId,a=e.participants,c=e.isVisible,i=e.width,l=e.height,d=e.socket,f=e.alerts,p=e.lockCall,b=e.muteCall,h=e.unmuteCall,E=e.isAudioOn,v=e.openChat,g=e.closeChat,y=e.chatCollapsed,O=e.addMessage,j=Object(m.d)((function(e){return e.session.user.token})),w=Object(m.d)((function(e){return e.session.user.id})),k=Object(n.useState)(!1),C=Object(u.a)(k,2),x=C[0],S=C[1],I=Object(n.useState)(!1),T=Object(u.a)(I,2),N=T[0],D=T[1],A=Object(n.useState)(),M=Object(u.a)(A,2),H=M[0],R=M[1],P=Object(n.useCallback)(Object(s.a)(o.a.mark((function e(){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new Ut(_t,d,t),e.next=3,a.init();case 3:R(a);case 4:case"end":return e.stop()}}),e)}))),[d,t]),L=function(){var e=Object(s.a)(o.a.mark((function e(a){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e,a){d.emit("info",{callId:t},e)}));case 2:n=e.sent,r=n.participants,d.emit("textMessage",{callId:t,contents:a.body,recipients:r}),De("Alert succesfully issue.","Both parties have been notified.","success");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){S(!0),N||Object(s.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d.connected){e.next=6;break}return console.log("Not connected, so waiting until connected."),window.Debug=d,e.next=5,new Promise((function(e){return d.on("connect",e)}));case 5:console.log("OK");case 6:return e.next=8,new Promise((function(e){d.emit("authenticate",{type:"monitor",id:w,token:j},e)}));case 8:return e.next=10,P();case 10:console.log("authenticated"),D(!0);case 12:case"end":return e.stop()}}),e)})))()}),[t,w,j,d,P,N]),Object(n.useEffect)((function(){H&&N&&H.socket.on("textMessage",(function(e){var a=e.from,n={content:e.contents,from:a.type,timestamp:(new Date).toLocaleDateString()};O(t,n)}))}),[O,t,N,H]);var B=Object(n.useCallback)((function(e){null!==e&&H&&N&&Object(s.a)(o.a.mark((function n(){return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:H.on("consume",function(){var n=Object(s.a)(o.a.mark((function n(r,c,i){var l,s,u,d,m,f;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!e){n.next=5;break}if(i.id===a.userId||i.id===a.inmateId){n.next=3;break}return n.abrupt("return");case 3:"video"===r?(l="".concat(i.type,"-").concat(t,"-").concat(i.id,"-video"),(s=document.getElementById(l))?s.srcObject=c:((u=document.createElement("video")).style.width="50%",u.style.height="100%",u.srcObject=c,u.id=l,u.autoplay=!0,e.appendChild(u))):"audio"===r&&(d="".concat(i.type,"-").concat(t,"-").concat(i.id,"-audio"),(m=document.getElementById(d))?m.srcObject=c:((f=document.createElement("audio")).srcObject=c,f.autoplay=!0,f.id=d,f.muted=!E,e.appendChild(f))),S(!1);case 5:case"end":return n.stop()}}),n)})));return function(e,t,a){return n.apply(this,arguments)}}());case 1:case"end":return n.stop()}}),n)})))()}),[H,N,E,t,a]);return Object(n.useEffect)((function(){var e=document.getElementById("inmate-".concat(t,"-").concat(a.inmateId,"-audio")),n=document.getElementById("user-".concat(t,"-").concat(a.userId,"-audio"));e&&(e.muted=E),n&&(n.muted=E)}),[E,a,t]),Object(n.useEffect)((function(){if(H){var e=setInterval((function(){H.socket.emit("heartbeat",{callId:t})}),1e3);return function(){return clearInterval(e)}}}),[H,t]),r.a.createElement("div",{className:"video-wrapper",id:"call-".concat(t),style:{width:i,height:l,visibility:c?"visible":"hidden",display:c?"flex":"none"},ref:B},!E&&r.a.createElement($t.a,{style:{position:"absolute",bottom:24,right:24,fontSize:36,color:"red"}}),r.a.createElement(na,{alerts:f,terminateCall:function(){H&&(H.terminate(),De("Call #".concat(t," terminated"),"We notified both participants of the incident.","info"))},lockCall:function(){return p(t)},muteCall:function(){return b(t)},unmuteCall:function(){return h(t)},isAudioOn:E,emitAlert:L,openChat:function(){return v(t)},closeChat:function(){return g(t)},chatCollapsed:y}),x&&r.a.createElement(ra,null))})),ia=a(916);function la(e){var t=e.width,a=e.height;return r.a.createElement(ia.a.Ribbon,{text:"Offline"},r.a.createElement(h.a,{style:{width:t,height:a},className:"video-wrapper"}))}var oa={backgroundColor:"white",boxShadow:"0 2px 4px rgb(53 72 88 / 7%",marginBottom:"16px",paddingLeft:24,paddingRight:24,display:"flex",alignItems:"center",lineHeight:1.2};function sa(e){var t=e.title,a=e.subtitle,n=e.extra;return r.a.createElement(f.a.Header,{style:Object(q.a)(Object(q.a)({},oa),{},{paddingTop:(null===n||void 0===n?void 0:n.length)?"72px":"48px",paddingBottom:(null===n||void 0===n?void 0:n.length)?"72px":"48px"})},r.a.createElement(p.b,{direction:"vertical",style:re},r.a.createElement(E.a.Title,{level:3,style:{marginBottom:0}},t),r.a.createElement(E.a.Text,null,a),(null===n||void 0===n?void 0:n.length)&&r.a.createElement("hr",{style:{border:0,height:1,backgroundColor:"rgba(0,0,0,.15)"}}),r.a.createElement(b.a,{gutter:16},null===n||void 0===n?void 0:n.map((function(e,t){return r.a.createElement(Rt.a,{key:t},e)})))))}function ua(e){var t=e.message,a=t.from;return r.a.createElement(p.b,{direction:"vertical",align:"inmate"===a?"end":"start",style:{width:"100%"}},r.a.createElement(p.b,null,r.a.createElement(E.a.Text,{strong:!0},function(){switch(a){case"inmate":return"Incarcerated Person";case"monitor":return"DOC";case"user":return"Loved One"}}()),r.a.createElement(E.a.Text,{type:"secondary"},Object(pe.a)(new Date(t.timestamp),"HH:mm"))),r.a.createElement(E.a.Text,null,t.content))}var da=f.a.Content,ma=f.a.Sider,fa=We.addMessage,pa={fetchCalls:ze,addMessage:fa},ba=Object(m.c)((function(e){return{visitations:Dt(e)}}),pa),ha=[1,2,4,6,8],Ea=ba((function(e){var t=e.visitations,a=e.fetchCalls,c=Object(n.useState)(),i=Object(u.a)(c,2),l=i[0],o=i[1],s=Object(n.useState)(),d=Object(u.a)(s,2),m=d[0],h=d[1],E=Object(n.useState)([]),v=Object(u.a)(E,2),g=v[0],y=v[1],O=Object(n.useState)(!1),j=Object(u.a)(O,2),w=j[0],k=j[1],C=Object(n.useState)(1),x=Object(u.a)(C,2),S=x[0],I=x[1],T=Object(n.useState)(80),N=Object(u.a)(T,2),D=N[0],A=N[1],M=Object(n.useState)(1),H=Object(u.a)(M,2),R=H[0],P=H[1],L=Object(n.useState)({}),B=Object(u.a)(L,2),F=B[0],V=B[1];Object(n.useEffect)((function(){var e=setInterval((function(){var e=(new Date).getTime();a({approved:!0,firstLive:[0,e].join(","),end:[e,e+1e8].join(",")})}),3e4);return function(){return clearInterval(e)}}),[a]),Object(n.useEffect)((function(){l||o(le.a.connect("wss://connect-api-staging.ameelio.org/"))}),[o,l]),Object(n.useEffect)((function(){!m&&t.length>0&&h(t[0].id)}),[S,t,m]),Object(n.useEffect)((function(){var e=t.find((function(e){return e.id===m}));y((null===e||void 0===e?void 0:e.messages)||[])}),[m,t]);var z=function(e){I(e),A(or[e])},U=Object(n.useCallback)((function(e,t){fa({id:e,message:t})}),[]);return r.a.createElement(da,null,r.a.createElement(sa,{title:"Live Calls (".concat(t.length,")"),subtitle:"Monitor, send alerts and terminate calls if needed. All in real-time"}),r.a.createElement(f.a,null,r.a.createElement(da,null,r.a.createElement(p.b,{direction:"vertical",style:Object(q.a)(Object(q.a)({},re),ae)},t.length>0&&r.a.createElement(Ht.a,{current:R,defaultCurrent:1,defaultPageSize:S,onChange:function(e,t){P(e)},pageSize:S,pageSizeOptions:ha.filter((function(e){return e<=t.length})).map((function(e){return"".concat(e)})),total:t.length,showSizeChanger:!0,onShowSizeChange:function(e,t){z(t)}}),r.a.createElement(b.a,{gutter:16},t.map((function(e,a){return r.a.createElement(Rt.a,{span:lr[S],key:e.id},l?r.a.createElement(ca,{height:"".concat(D,"vh"),socket:l,callId:e.id,participants:e.connection,isVisible:a>=(R-1)*S&&a<(R-1)*S+S,width:"100%",alerts:sr,muteCall:function(e){V(he.a.omit(F,e))},unmuteCall:function(e){return V(Object(q.a)(Object(q.a)({},F),{},Object(te.a)({},e,!0)))},isAudioOn:e.id in F,openChat:function(e){var a=t.find((function(t){return t.id===e}));h(e),y((null===a||void 0===a?void 0:a.messages)||[]),k(!1)},closeChat:function(e){k(!0)},chatCollapsed:w,addMessage:U,lockCall:function(e){var a=t.findIndex((function(t){return t.id===e}));-1!==a&&(z(1),P(a+1),h(a))}}):r.a.createElement(la,{width:"100%",height:"".concat(D,"vh")}))}))))),r.a.createElement(ma,{theme:"light",width:300,collapsible:!0,defaultCollapsed:!0,reverseArrow:!0,collapsed:w,onCollapse:function(e){return k(e)}},!w&&r.a.createElement("div",null,r.a.createElement(Pt.a,{title:"Chat",extra:[r.a.createElement(Lt.a,{value:m,onSelect:function(e){return h(e)}},t.map((function(e){return r.a.createElement(Lt.a.Option,{value:e.id,key:e.id},"Call #",e.id)})))]})," ",r.a.createElement("div",{style:ae},r.a.createElement(p.b,{direction:"vertical",style:{overflowY:"scroll",display:"flex",flexDirection:"column",height:"100%"}},g.map((function(e){return r.a.createElement(ua,{message:e})}))))))))})),va=a(288),ga=a(500),ya=a(501),Oa=(a(613),function(e){var t=e.visitations,a=Object(n.useState)([]),c=Object(u.a)(a,2),i=c[0],l=c[1];Object(n.useEffect)((function(){l(t.map((function(e){return function(e){return{title:"".concat(we(e.connection.inmate)," <> ").concat(we(e.connection.contact)),start:e.scheduledStartTime,end:e.scheduledEndTime}}(e)})))}),[t]);return r.a.createElement("div",{className:"demo-app-main"},r.a.createElement(Ee.b,{plugins:[va.b,ga.a,ya.a],headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay"},initialView:"timeGridWeek",editable:!0,selectable:!0,selectMirror:!0,dayMaxEvents:!0,weekends:!1,businessHours:!0,events:i,eventContent:function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("b",null,e.timeText),r.a.createElement("i",null,e.event.title))},eventClick:function(e){window.confirm("Are you sure you want to delete the event '".concat(e.event.title,"'"))&&e.event.remove()},themeSystem:"bootstrap"}))}),ja=f.a.Content,wa=Object(m.c)((function(e){return{visitations:Tt(e,ht(e))}}))((function(e){var t=e.visitations;return r.a.createElement(ja,null,r.a.createElement(Pt.a,{title:"Calendar"}),r.a.createElement("div",{style:ae},r.a.createElement(Oa,{visitations:t})))})),ka=a(907),Ca=a(522),xa=ka.a.Column,Sa=f.a.Content,Ia={updateConnection:Me},Ta=Object(m.c)((function(e){return{requests:St(e,xt(e))}}),Ia)((function(e){var t=e.updateConnection,a=e.requests;return r.a.createElement(Sa,null,r.a.createElement(sa,{title:"Approval Requests",subtitle:"Review all connection requests between incarcerated people in your facility and their loved one on the outside."}),r.a.createElement(ka.a,{dataSource:a,style:ae},r.a.createElement(xa,{title:"",dataIndex:"inmate",key:"inmateProfilePic",render:function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ca.a,{src:e.profileImgPath,shape:"circle",size:{xs:24,sm:32,md:40,lg:64,xl:80,xxl:100}}))}}),r.a.createElement(xa,{title:"Inmate",dataIndex:"inmate",key:"inmateProfilePic",render:function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(p.b,{direction:"vertical"},r.a.createElement("span",null,we(e)),r.a.createElement("span",null,e.inmateNumber),r.a.createElement("span",null,e.location)))}}),r.a.createElement(xa,{title:"",dataIndex:"contact",key:"contactProfilePic",render:function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ca.a,{src:e.profileImgPath,shape:"circle",size:{xs:24,sm:32,md:40,lg:64,xl:80,xxl:100}}))}}),r.a.createElement(xa,{title:"Contact",dataIndex:"contact",key:"contactInfo",render:function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(p.b,{direction:"vertical"},r.a.createElement("span",null,we(e)),r.a.createElement("span",null,"Visitor ID: ",e.id),r.a.createElement("span",null,e.relationship)))}}),r.a.createElement(xa,{title:"",key:"actions",render:function(e,a){return r.a.createElement(p.b,null,r.a.createElement(O.a,{type:"primary",onClick:function(){return function(e){t({connectionId:e.id,status:"approved"})}(a)}},"Accept"),r.a.createElement(O.a,{danger:!0,onClick:function(){return function(e){t({connectionId:e.id,status:"denied"})}(a)}},"Reject"))}})))})),Na=a(157),Da=a(373).a.RangePicker;function Aa(e){var t=e.setDuration,a=e.setStartDate,n=e.setEndDate,c=[1/0,3,5,10,15,20],i=r.a.createElement(Wt.a,null,c.map((function(e){return r.a.createElement(Wt.a.Item,{key:e,onClick:function(){return t(e)}},"<",e)})));return r.a.createElement(p.b,{align:"center"},r.a.createElement(Da,{onChange:function(e){e&&(e[0]&&a(1e3*e[0].unix()),e[1]&&n(1e3*e[1].unix()))}}),r.a.createElement(Zt.a,{overlay:i,trigger:["click"]},r.a.createElement("a",{className:"ant-dropdown-link",onClick:function(e){return e.preventDefault()}},"Call Duration ",r.a.createElement(Na.a,null))))}var Ma=a(527),Ha=a(84),Ra=a(528),Pa=ka.a.Column,La=f.a.Content,Ba=Object(m.c)((function(e){return{logs:Tt(e,ht(e)).filter((function(e){return"ended"===e.status||"terminated"===e.status})),history:e.router}}),(function(e){return Object(V.b)({fetchCalls:ze,push:Ha.d},e)})),Fa={inmateId:"Member ID",inmateName:"Member Name",contactId:"Contact ID",contactName:"Contact Name",kioskName:"Kiosk Name"},qa=Ba((function(e){var t=e.logs,a=e.fetchCalls,c=e.push,i=Object(n.useState)([]),l=Object(u.a)(i,2),d=l[0],m=l[1],f=Object(n.useState)(""),b=Object(u.a)(f,2),h=b[0],E=b[1],v=Object(n.useState)(""),y=Object(u.a)(v,2),j=y[0],w=y[1],k=Object(n.useState)(100),C=Object(u.a)(k,1)[0],x=Object(n.useState)(0),S=Object(u.a)(x,1)[0],I=Object(n.useState)(),T=Object(u.a)(I,2),N=T[0],D=T[1],A=Object(n.useState)(),M=Object(u.a)(A,2),H=M[0],R=M[1],P=Object(n.useState)(),L=Object(u.a)(P,2),B=L[0],F=L[1],V=Object(n.useState)(!1),z=Object(u.a)(V,2),U=z[0],_=z[1],G=Object(n.useState)("inmateId"),W=Object(u.a)(G,2),Z=W[0],J=W[1],K=Object(n.useCallback)(he.a.debounce((function(){return w(h)}),1e3),[h]);return Object(n.useEffect)((function(){return K(),K.cancel}),[h,K]),Object(n.useEffect)((function(){_(!0),Object(s.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",a({query:j,startDate:N,endDate:H,minDuration:0,maxDuration:B,limit:C,offset:S}));case 1:case"end":return e.stop()}}),e)})))().then((function(){return _(!1)}))}),[a,C,S,N,H,B,j]),Object(n.useEffect)((function(){var e=t;if(N&&H&&(e=e.filter((function(e){return e.startTime>=N&&e.startTime<=H}))),h)switch(Z){case"inmateId":e=e.filter((function(e){return"".concat(e.connection.inmate.inmateNumber).includes(h)}));break;case"inmateName":e=e.filter((function(e){return we(e.connection.inmate).includes(h)}));break;case"contactName":e=e.filter((function(e){return we(e.connection.contact).includes(h)}));break;case"contactId":e=e.filter((function(e){return"".concat(e.connection.contact.id).includes(h)}))}m(e)}),[t,m,N,H,Z,h]),r.a.createElement(La,null,r.a.createElement(sa,{title:"Search for Call Logs",subtitle:"Search by different parameters and retrieve recordings of past calls",extra:[r.a.createElement(g.a.Group,{compact:!0},r.a.createElement(Lt.a,{defaultValue:"inmateId",onSelect:function(e){return J(e)}},Object.keys(Fa).map((function(e){return r.a.createElement(Lt.a.Option,{key:e,value:e},Fa[e])}))),r.a.createElement(g.a.Search,{style:{width:"auto"},placeholder:"Search by ".concat(Fa[Z],"..."),allowClear:!0,value:h,onChange:function(e){E(e.target.value)},onSearch:function(e){w(e)}})),r.a.createElement(Aa,{setStartDate:D,setEndDate:R,setDuration:F})]}),r.a.createElement(p.b,{direction:"vertical",style:Object(q.a)(Object(q.a)({},ae),re)},r.a.createElement(ka.a,{dataSource:d,loading:U},r.a.createElement(Pa,{title:"Date",dataIndex:"scheduledStartTime",key:"date",render:function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("span",null,Object(pe.a)(e,"MM/dd/yy")))}}),r.a.createElement(Pa,{title:"Start Time",dataIndex:"scheduledStartTime",key:"startTime",render:function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("span",null,Object(pe.a)(e,"HH:mm")))}}),r.a.createElement(Pa,{title:"End Time",dataIndex:"scheduledEndTime",key:"endTime",render:function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("span",null,Object(pe.a)(e,"HH:mm")))}}),r.a.createElement(Pa,{title:"Inmate Name",dataIndex:"connection",key:"connection",render:function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("span",null,we(e.inmate)))}}),r.a.createElement(Pa,{title:"Inmate ID",dataIndex:"connection",key:"inmateId",render:function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("span",null,e.inmate.inmateNumber))}}),r.a.createElement(Pa,{title:"Contact Name",dataIndex:"connection",key:"contactName",render:function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("span",null,we(e.contact)))}}),r.a.createElement(Pa,{title:"Location",dataIndex:"connection",key:"location",render:function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("span",null,e.inmate.location))}}),r.a.createElement(Pa,{title:"Status",dataIndex:"status",key:"location",render:function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ma.a,null,e))}}),r.a.createElement(Pa,{title:"Recording",key:"action",render:function(e,t){return r.a.createElement(p.b,{size:"middle"},r.a.createElement(O.a,{onClick:function(){return c("/call/".concat(t.id))},icon:r.a.createElement(Ra.a,null)},"View"))}}))))})),Va=a(903),za=a(923),Ua=a(931),_a=Lt.a.Option;function Ga(e){var t=e.data,a=e.onChange,n=v.a.useForm(),c=Object(u.a)(n,1)[0];return r.a.createElement(v.a,{form:c,name:"control-hooks"},r.a.createElement(v.a.Item,{name:"email",label:"Email",rules:[{type:"email",required:!0}]},r.a.createElement(g.a,{placeholder:"Email",prefix:r.a.createElement(Ua.a,{className:"site-form-item-icon"}),value:t.email,onChange:function(e){return a(Object(q.a)(Object(q.a)({},t),{},{email:e.target.value}))}})),r.a.createElement(v.a.Item,{name:"gender",label:"Role",rules:[{required:!0}]},r.a.createElement(Lt.a,{placeholder:"Select a role",value:t.role,onChange:function(e){return a(Object(q.a)(Object(q.a)({},t),{},{role:e}))},allowClear:!0},r.a.createElement(_a,{value:"operator"},"Operator"),r.a.createElement(_a,{value:"investigator"},"Investigator"),r.a.createElement(_a,{value:"warden"},"Warden"),r.a.createElement(_a,{value:"admin"},"Admin"))),r.a.createElement(v.a.Item,null,Object.keys(nr).map((function(e){return r.a.createElement("div",null,r.a.createElement("span",null,nr[e]),r.a.createElement(za.a,{defaultChecked:!1,checked:t.permissions.includes(e),onChange:function(n){a(n?Object(q.a)(Object(q.a)({},t),{},{permissions:[].concat(Object(oe.a)(t.permissions),[e])}):Object(q.a)(Object(q.a)({},t),{},{permissions:t.permissions.filter((function(t){return t!==e}))}))}}))}))))}var Wa=a(932),Za=ka.a.Column,Ja=f.a.Content,Ka=Object(m.c)((function(e){return{staff:vt(e)}}),(function(e){return Object(V.b)({updateStaff:Z},e)}))((function(e){var t=e.staff,a=e.updateStaff,c=Object(n.useState)(null),i=Object(u.a)(c,2),l=i[0],o=i[1],s=Object(n.useState)(),d=Object(u.a)(s,2),m=d[0],f=d[1],b=Object(n.useState)(!1),h=Object(u.a)(b,2),E=h[0],v=h[1],g=Object(n.useState)({email:"",role:"",permissions:[]}),y=Object(u.a)(g,2),j=y[0],w=y[1],k=Object(n.useState)({allowRead:!1,allowCalltimes:!1,allowApproval:!1,allowRestructure:!1,allowMonitor:!1}),C=Object(u.a)(k,2),x=C[0],S=C[1],I=function(){switch(v(!0),l){case"edit":m&&a({userId:m.id,permissions:Object.keys(x).filter((function(e){return x[e]}))})}v(!1)};return Object(n.useEffect)((function(){var e;m&&S({allowRead:(e=m.permissions).includes("allowRead"),allowApproval:e.includes("allowApproval"),allowMonitor:e.includes("allowMonitor"),allowCalltimes:e.includes("allowCalltimes"),allowRestructure:e.includes("allowRestructure")})}),[m]),r.a.createElement(Ja,null,r.a.createElement(sa,{title:"Staff",subtitle:"Manage your staff, edit their access permissions, and add new members.",extra:[r.a.createElement(O.a,{onClick:function(){return o("create")},icon:r.a.createElement(Wa.a,null)},"Add Staff Member")]}),r.a.createElement("div",{style:ae},r.a.createElement(ka.a,{dataSource:t},r.a.createElement(Za,{title:"",dataIndex:"profileImgPath",key:"profileImgPath",render:function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ca.a,{src:e,size:"large"}))}}),r.a.createElement(Za,{title:"First Name",dataIndex:"firstName",key:"firstName"}),r.a.createElement(Za,{title:"Last Name",dataIndex:"lastName",key:"lastName"}),r.a.createElement(Za,{title:"Role",dataIndex:"role",key:"role",render:function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ma.a,{color:"blue",key:e},e||"Operator"))}}),r.a.createElement(Za,{title:"",key:"edit",render:function(e,t){return r.a.createElement(O.a,{onClick:function(){f(t),o("edit")}},"Edit")}}))),r.a.createElement(Jt.a,{title:"Add Staff",visible:"create"===l,onOk:I,confirmLoading:E,onCancel:function(){return o(null)}},r.a.createElement(Ga,{data:j,onChange:w})),r.a.createElement(Jt.a,{title:"Edit Staff",visible:"edit"===l,onOk:I,confirmLoading:E,onCancel:function(){return o(null)}},m&&r.a.createElement(p.b,{direction:"vertical",size:"small",style:{width:"100%"}},r.a.createElement("span",null,"Name: ",we(m)),r.a.createElement("span",null,"Role: ",m.role),r.a.createElement("span",null,"Email: ",m.email),r.a.createElement(Va.a,null),Object.keys(nr).map((function(e){return r.a.createElement(p.b,null,r.a.createElement("span",null,nr[e]),r.a.createElement(za.a,{defaultChecked:m.permissions.includes(e),checked:x[e],onChange:function(t){var a=ke(x);a[e]=t,S(a)}}))})))))})),Qa=a(904),Ya=a(529),$a=a(917),Xa=function(e){var t=e.children,a=e.editing,n=e.dataIndex,c=e.title,i=e.inputType,l=(e.record,e.index,Object(Ya.a)(e,["children","editing","dataIndex","title","inputType","record","index"])),o="number"===i?r.a.createElement($a.a,null):r.a.createElement(g.a,null);return r.a.createElement("td",l,a?r.a.createElement(v.a.Item,{name:n,style:{margin:0},rules:[{required:!1,message:"Please Input ".concat(c,"!")}]},o):t)};function en(e){var t=e.originalData,a=e.columns,c=e.onSave,i=e.onViewItem,l=v.a.useForm(),d=Object(u.a)(l,1)[0],m=Object(n.useState)(t),f=Object(u.a)(m,2),b=f[0],h=f[1],g=Object(n.useState)(null),y=Object(u.a)(g,2),j=y[0],w=y[1],k=function(e){return e.id===j},C=function(){w(null)},x=function(){var e=Object(s.a)(o.a.mark((function e(t){var a,n,r,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d.validateFields();case 3:if(a=e.sent,n=Object(oe.a)(b),!((r=n.findIndex((function(e){return t===e.id})))>-1)){e.next=15;break}return i=n[r],n.splice(r,1,Object(q.a)(Object(q.a)({},i),a)),e.next=11,c(n[r]);case 11:h(n),w(null),e.next=18;break;case 15:n.push(a),h(n),w(null);case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(0),console.log("Validate Failed:",e.t0);case 23:case"end":return e.stop()}}),e,null,[[0,20]])})));return function(t){return e.apply(this,arguments)}}(),S=a.concat([{title:"",dataIndex:"operation",render:function(e,t){return k(t)?r.a.createElement(p.b,null,r.a.createElement(E.a.Link,{onClick:function(){return x(t.id)}},"Save"),r.a.createElement(Qa.a,{title:"Sure to cancel?",onConfirm:C},r.a.createElement(E.a.Link,null,"Cancel"))):r.a.createElement(p.b,{size:"large"},r.a.createElement(E.a.Link,{disabled:null!==j,onClick:function(){return function(e){d.setFieldsValue(Object(q.a)({},e)),w(e.id)}(t)}},"Quick Edit"),r.a.createElement(O.a,{disabled:null!==j,onClick:function(){return i(t.id)},icon:r.a.createElement(Ra.a,null)},"View"))}}]).map((function(e){return e.editable?Object(q.a)(Object(q.a)({},e),{},{onCell:function(t){return{record:t,inputType:"text",dataIndex:e.dataIndex,title:e.title,editing:k(t)}}}):e}));return r.a.createElement(v.a,{form:d,component:!1},r.a.createElement(ka.a,{components:{body:{cell:Xa}},bordered:!0,dataSource:b,columns:S,pagination:{onChange:C}}))}var tn=f.a.Content,an={updateInmate:$,push:Ha.d},nn=Object(m.c)((function(e){return{inmates:ut(e)}}),an)((function(e){var t=e.updateInmate,a=e.inmates,n=e.push,c=[{title:"",dataIndex:"profileImgPath",editable:!1,render:function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ca.a,{src:e,size:"large"}))}},{title:"Inmate Number",dataIndex:"inmateNumber",editable:!0},{title:"First Name",dataIndex:"firstName",editable:!0},{title:"Last Name",dataIndex:"lastName",editable:!0},{title:"Location",dataIndex:"location",editable:!0}];return r.a.createElement(tn,null,r.a.createElement(sa,{title:"Incarcerated People",subtitle:"Manage the members of your facility, access detailed information, and edit their info as needed."}),r.a.createElement("div",{style:ae},r.a.createElement(en,{originalData:a,columns:c,onSave:function(e){return t(e)},onViewItem:function(e){return n("/members/".concat(e))}})))})),rn=a(920),cn=a(918),ln=a(306),on=f.a.Content,sn={push:Ha.d},un=Object(m.c)((function(e,t){return{inmate:st(e,parseInt(t.match.params.id)),connections:At(e,parseInt(t.match.params.id))||[],calls:Tt(e,Mt(e,parseInt(t.match.params.id))||[])}}),sn),dn=function(e){var t=Object(pe.a)(e.scheduledStartTime,"MM/dd HH:mm");switch(e.status){case"scheduled":return r.a.createElement(rn.a.Item,{label:t,color:"yellow"},"Call scheduled with ",we(e.connection.contact));case"cancelled":return r.a.createElement(rn.a.Item,{label:t,color:"red"},"Call with ",we(e.connection.contact)," was cancelled");case"missing-monitor":case"live":return r.a.createElement(rn.a.Item,{label:t,color:"green"},"Call happening with ",we(e.connection.contact));case"terminated":case"ended":return e.videoReady?r.a.createElement(rn.a.Item,{label:Object(pe.a)(e.scheduledStartTime,"MM/dd HH:mm")},r.a.createElement(E.a.Link,{onClick:function(){return Object(Ha.d)("/call/".concat(e.id))}},"Called ",we(e.connection.contact))):r.a.createElement(rn.a.Item,{dot:r.a.createElement(ln.a,{style:{fontSize:"16px"}}),label:t},r.a.createElement(E.a.Link,{onClick:function(){return Object(Ha.d)("/call/".concat(e.id))}},"Processsing call with ",we(e.connection.contact)))}};var mn=un((function(e){var t=e.inmate,a=e.connections,n=e.calls,c=(e.push,Object(m.d)((function(e){var t;return null===(t=e.facilities.selected)||void 0===t?void 0:t.name})));if(!t||!c)return r.a.createElement("div",null);var i=[{path:"/",breadcrumbName:c},{path:"/members",breadcrumbName:"Logs"},{path:"/",breadcrumbName:we(t)}];return r.a.createElement(f.a,null,r.a.createElement(on,{style:Object(q.a)({},ae)},r.a.createElement(Pt.a,{ghost:!1,onBack:function(){return window.history.back()},title:we(t),subTitle:c,breadcrumb:{routes:i},style:{marginBottom:32}},r.a.createElement(cn.b,{size:"small",column:3},r.a.createElement(cn.b.Item,{label:"First Name"},t.firstName),r.a.createElement(cn.b.Item,{label:"Last Name"},t.lastName),r.a.createElement(cn.b.Item,{label:"Unique ID"},t.inmateNumber),r.a.createElement(cn.b.Item,{label:"Location"},t.location),r.a.createElement(cn.b.Item,{label:"DOB"},t.dob),r.a.createElement(cn.b.Item,{label:"Race"},t.race),r.a.createElement(cn.b.Item,{label:"Sentence"},t.sentence),r.a.createElement(cn.b.Item,{label:"Sentence Length"},t.sentnceLength),r.a.createElement(cn.b.Item,{label:"Call Quota"},t.quota))),r.a.createElement(b.a,{justify:"space-between",gutter:12},r.a.createElement(Rt.a,{span:12},r.a.createElement(h.a,{title:"Call Activity"},!n.length&&r.a.createElement(E.a.Text,null,"No calls."),r.a.createElement(rn.a,{mode:"left"},n.map(dn)))),r.a.createElement(Rt.a,{span:12},r.a.createElement(h.a,{title:"Connections"},r.a.createElement(b.a,{justify:"space-between"},!a.length&&r.a.createElement(E.a.Text,null,"No connections."),a.map((function(e){return r.a.createElement(Rt.a,{span:8},r.a.createElement(p.b,{direction:"vertical",align:"center"},r.a.createElement(Ca.a,{src:e.contact.profileImgPath,size:80}),r.a.createElement(E.a.Text,null,we(e.contact)),r.a.createElement(E.a.Text,{type:"secondary"},e.relationship)))}))))))))})),fn=a(290),pn="rgba(0, 137, 255, 1)",bn=function(e){var t=e.title,a=e.label,n=e.labels,c=e.data,i={labels:n,datasets:[{label:a,lineTension:.1,backgroundColor:"rgba(0, 137, 255, 0.4)",borderColor:pn,borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:pn,pointBackgroundColor:"#fff",pointBorderWidth:5,pointHoverRadius:8,pointHoverBackgroundColor:pn,pointHoverBorderColor:"rgba(2, 117, 216, 1)",pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,data:c}]};return r.a.createElement(h.a,{title:t},r.a.createElement(fn.Line,{data:i}))};function hn(e){var t=e.title,a={labels:e.labels,datasets:[{data:e.data,backgroundColor:e.backgroundColor,hoverBackgroundColor:e.hoverBackgroundColor}]};return r.a.createElement(h.a,{title:t,style:ne},r.a.createElement(fn.Doughnut,{data:a}))}var En=a(934),vn=a(935),gn=a(936),yn=a(35),On=yn.d.create({container:{flexDirection:"row",borderBottomWidth:2,borderBottomColor:"#112131",borderBottomStyle:"solid",padding:8,alignItems:"stretch"},extraColumn:{flexDirection:"column",flexGrow:2,alignSelf:"flex-end"},detailColumn:{flexDirection:"column",flexGrow:9,textTransform:"uppercase"},name:{fontSize:24,fontWeight:"bold"},subtitle:{fontSize:10},extra:{fontSize:10,color:"black",alignSelf:"flex-end",fontStyle:"italic"}}),jn=function(e){var t=e.title,a=e.subtitle,n=e.extra;return r.a.createElement(yn.f,{style:On.container},r.a.createElement(yn.f,{style:On.detailColumn},r.a.createElement(yn.e,{style:On.name},t),r.a.createElement(yn.e,{style:On.subtitle},a)),r.a.createElement(yn.f,{style:On.extraColumn},r.a.createElement(yn.e,{style:On.extra},n)))},wn=yn.d.create({container:{width:"100%",backgroundColor:"#e5f2ff",padding:4},title:{fontWeight:"bold",fontSize:16,textTransform:"uppercase",width:"100%"}}),kn=function(e){var t=e.title;return r.a.createElement(yn.f,{style:wn.container},r.a.createElement(yn.e,{style:wn.title},t))},Cn=yn.d.create({container:{padding:8,borderBottomWidth:2,borderBottomColor:"#112131",marginBottom:8},row:{display:"flex",borderBottomStyle:"solid",justifyContent:"space-between",flexDirection:"row",marginVertical:8},header:{textDecoration:"underline",fontWeight:"bold"}}),xn=function(e){e.block;var t=e.calls,a=e.canViewDetails;return r.a.createElement(yn.f,{style:Cn.container},t.map((function(e){return r.a.createElement(yn.f,{key:e.id},r.a.createElement(yn.f,{style:Cn.row},r.a.createElement(yn.f,null,r.a.createElement(yn.e,{style:Cn.header},"Call ID"),r.a.createElement(yn.e,null,e.id)),r.a.createElement(yn.f,null,r.a.createElement(yn.e,{style:Cn.header},"Call Station"),r.a.createElement(yn.e,null,e.kiosk.name))),r.a.createElement(yn.f,{style:Cn.row},r.a.createElement(yn.f,null,r.a.createElement(yn.e,{style:Cn.header},"Incarcerated Person"),r.a.createElement(yn.e,null,we(e.connection.inmate))),r.a.createElement(yn.f,null,r.a.createElement(yn.e,{style:Cn.header},"Unique ID"),r.a.createElement(yn.e,null,e.connection.inmate.inmateNumber)),r.a.createElement(yn.f,null,r.a.createElement(yn.e,{style:Cn.header},"Housing"),r.a.createElement(yn.e,null,e.connection.inmate.location))),a&&r.a.createElement(yn.f,{style:Cn.row},r.a.createElement(yn.f,null,r.a.createElement(yn.e,{style:Cn.header},"Contact ID"),r.a.createElement(yn.e,null,e.connection.contact.id)),r.a.createElement(yn.f,null,r.a.createElement(yn.e,{style:Cn.header},"Contact Name"),r.a.createElement(yn.e,null,we(e.connection.contact))),r.a.createElement(yn.f,null,r.a.createElement(yn.e,{style:Cn.header},"Relationship"),r.a.createElement(yn.e,null,e.connection.contact.relationship))))})))},Sn=yn.d.create({page:{padding:30},container:{flex:1,flexDirection:"row"}}),In=r.a.memo((function(e){var t=e.callBlocks,a=e.facility,n=e.canViewDetails;return r.a.createElement(yn.a,{author:"Ameelio.org",keywords:"schedule, conneect",title:"Daily Schedule"},r.a.createElement(yn.c,{style:Sn.page},r.a.createElement(jn,{title:"Daily Activity Report",subtitle:"".concat(a.name),extra:"Generated on ".concat(Object(pe.a)(new Date,"MMMM/dd/yyyy HH:mm:ss"))}),Object.keys(t).map((function(e){return r.a.createElement(yn.f,{key:e},r.a.createElement(kn,{title:Object(pe.a)(new Date(parseInt(e)),"HH:mm")}),r.a.createElement(xn,{block:parseInt(e),calls:t[e],canViewDetails:n}))}))))})),Tn=a(933),Nn=r.a.memo((function(e){var t=e.calls,a=e.facility,c=e.canViewDetails,i=Object(n.useState)(!1),l=Object(u.a)(i,2),o=l[0],s=l[1];return Object(n.useEffect)((function(){setTimeout((function(){return s(!0)}),2e3)}),[]),o?r.a.createElement(yn.b,{document:r.a.createElement(In,{callBlocks:he.a.groupBy(t,(function(e){return e.scheduledStartTime})),facility:a,canViewDetails:!0}),fileName:"Daily Schedule | ".concat(null===a||void 0===a?void 0:a.name,"@").concat(Object(pe.a)(new Date,"MM/dd/yyyy-HH:mm"))},r.a.createElement(O.a,{icon:r.a.createElement(Tn.a,null)},"Download Schedule ",c?"(Admin)":"(Public)")):r.a.createElement(O.a,{disabled:!0,loading:!0},"Generating daily report...")})),Dn=a(912);function An(e){var t=e.title,a=e.value,n=e.suffix,c=e.prefix;return r.a.createElement(h.a,null,r.a.createElement(Dn.a,{title:t,value:a,prefix:c,suffix:n}))}var Mn=f.a.Content,Hn={fetchCalls:ze};var Rn=Object(m.c)((function(e){return{facility:e.facilities.selected,calls:Tt(e,ht(e)),numInmates:dt(e)}}),Hn)((function(e){var t=e.facility,a=e.calls,c=e.numInmates,i=Object(n.useState)(),l=Object(u.a)(i,2),o=l[0],s=l[1],d=Object(n.useState)(),m=Object(u.a)(d,2),h=m[0],E=m[1];return Object(n.useEffect)((function(){var e=he.a.groupBy(a.filter((function(e){return!!e.rating})),(function(e){return e.rating})),t=he.a.keys(e).sort();s(t.map((function(t){return e[t].length}))),E(function(e){for(var t=new Date,a=ye(t),n={},r=ye(Object(fe.a)(t));r<=a;){var c=Object(Ee.a)(r,1);n[Object(pe.a)(r,"MMM dd")]=Oe(e,r,c).length,r=c}return n}(a))}),[a]),o&&h&&t?r.a.createElement(f.a,null,r.a.createElement(sa,{title:"Dashboard",subtitle:"Analyze your facility data and print the daily call schedule.",extra:[r.a.createElement(Nn,{calls:je(a),facility:t,canViewDetails:!0}),r.a.createElement(Nn,{calls:je(a),facility:t,canViewDetails:!1})]}),r.a.createElement(Mn,null,r.a.createElement(p.b,{direction:"vertical",style:Object(q.a)(Object(q.a)({},re),ae),size:"large"},r.a.createElement(b.a,{gutter:16},r.a.createElement(Rt.a,{span:8,className:"bg-white"},r.a.createElement(An,{title:"Calls This Week",value:Object.values(h)[Object.values(h).length-1],prefix:r.a.createElement(En.a,null),suffix:"calls"})),r.a.createElement(Rt.a,{span:8,className:"bg-white"},r.a.createElement(An,{title:"Live Video Calls",value:a.filter((function(e){return"live"===e.status||"missing-monitor"===e.status})).length,prefix:r.a.createElement(vn.a,null),suffix:"calls"})),r.a.createElement(Rt.a,{span:8,className:"bg-white"},r.a.createElement(An,{title:"Facility Video Usage",value:(100*a.map((function(e){return e.connection.inmateId})).filter(Ce).length/c).toFixed(2),suffix:"%",prefix:r.a.createElement(gn.a,null)}))),r.a.createElement(b.a,{gutter:16},r.a.createElement(Rt.a,{span:12},r.a.createElement(bn,{title:"Calls",label:"# calls",labels:Object.keys(h),data:Object.values(h)})),r.a.createElement(Rt.a,{span:12},r.a.createElement(hn,{title:"Ratings Breakdown ".concat(Object(pe.a)(new Date,"MMMM")),data:o,backgroundColor:ce,hoverBackgroundColor:ce,labels:["Terrible","Poor","Okay","Good","Amazing"]})))))):r.a.createElement("div",null)})),Pn=a(905),Ln=a(909),Bn=a(105),Fn=a.n(Bn),qn=a(374),Vn=qn.a.TabPane,zn=Pn.a.RangePicker,Un=f.a.Content,_n={updateCallTimes:Qe};var Gn=Object(m.c)((function(e){return{facility:e.facilities.selected,nodes:jt(e)}}),_n)((function(e){var t=e.facility,a=e.nodes,c=e.updateCallTimes,i=Object(n.useState)(),l=Object(u.a)(i,2),o=l[0],s=l[1],d=Object(n.useState)("setting"),m=Object(u.a)(d,2),f=m[0],v=m[1],g=Object(n.useState)([]),y=Object(u.a)(g,2),j=y[0],w=y[1];if(Object(n.useEffect)((function(){t&&(w(t.callTimes),s(function(e){console.log("calltimes"),console.log(e);var t=he.a.groupBy(e,(function(e){return e.start.day}));console.log(t);var a=cr.map((function(e){return e in t?[e,t[e].sort((function(e,t){return e.start.hour>t.start.hour?1:e.start.hour<t.start.hour?-1:e.start.minute>t.start.minute?1:e.start.minute<t.start.minute?-1:1}))]:[e,[]]})),n=0,r=a.map((function(e){var t=Object(u.a)(e,2),a=t[0],r=t[1];if(!r.length)return Object(te.a)({},a,[]);var c,i=[],l=r[0],o=r[0],s=Object(se.a)(r.slice(1,r.length));try{for(s.s();!(c=s.n()).done;){var d=c.value;l.start.hour===d.start.hour||d.start.hour===l.start.hour+1&&0===d.start.minute?l=d:(i.push({duration:ir,start:ve(o),end:ge(l),idx:n,day:o.start.day}),o=d,l=d,n+=1)}}catch(m){s.e(m)}finally{s.f()}return i.push({duration:ir,start:ve(o),end:ge(l),idx:n,day:o.start.day}),Object(te.a)({},a,i)}));return Object.assign.apply(Object,[{}].concat(Object(oe.a)(r)))}(t.callTimes)))}),[t]),!t||!o)return r.a.createElement("div",null);var k=function(e,t,a,n){var r=ke(o);r[a][n]={start:e.toString(),end:t.toString(),duration:ir,idx:n,day:a},w(function(e){var t=cr.map((function(t){return e[t]||[]})).reduce((function(e,t){return e.concat(t)}),[]);return console.log(t),t.map((function(e){var t=new Date(e.start),a=new Date(e.end);if(t>a)throw new Error("Invalid time range");for(var n=[];t<a;)n.push({start:{hour:Object(de.a)(t),minute:Object(me.a)(t),day:e.day},duration:e.duration}),t=Object(ue.a)(t,e.duration),console.log(t);return n})).reduce((function(e,t){return e.concat(t)}),[])}(r)),s(r)};return r.a.createElement(Un,null,r.a.createElement(sa,{title:"Settings",subtitle:"Adjust the call hours, facility information, and facility kiosk directory as needed."}),r.a.createElement("div",{style:ae},r.a.createElement(Un,{style:Object(q.a)({},ae)},r.a.createElement(qn.a,{defaultActiveKey:f,onChange:function(e){v(e)}},r.a.createElement(Vn,{tab:"General Settings",key:"setting"},r.a.createElement(h.a,{title:"Call Hours",extra:[r.a.createElement(O.a,{type:"primary",onClick:function(e){c({callSlots:j,zone:"America_LosAngeles"})}},"Save Changes")]},r.a.createElement(p.b,{direction:"vertical"},cr.map((function(e){return function(e,t){return r.a.createElement(b.a,{style:{width:"100%",margin:16}},r.a.createElement(Rt.a,{span:12},r.a.createElement(E.a.Title,{level:5},["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][e]||"")),r.a.createElement(Rt.a,{span:12},r.a.createElement(p.b,{direction:"vertical",style:re},t.map((function(t){return r.a.createElement(zn,{minuteStep:30,use12Hours:!0,defaultValue:[Fn()(Object(pe.a)(new Date(t.start),"HH:mm"),"HH:mm"),Fn()(Object(pe.a)(new Date(t.end),"HH:mm"),"HH:mm")],onChange:function(a){a&&a[0]&&a[1]&&k(a[0].toDate(),a[1].toDate(),e,t.idx)},format:"HH:mm"})})),r.a.createElement(zn,{format:"HH:mm",minuteStep:30,use12Hours:!0,onChange:function(a){a&&a[0]&&a[1]&&k(a[0].toDate(),a[1].toDate(),e,t.length)}}))))}(e,o[e])}))))),r.a.createElement(Vn,{tab:"Facility",key:"facility"},r.a.createElement(Ln.a,{treeData:a,defaultExpandAll:!0,draggable:!0}))))))})),Wn=a(516),Zn=a.n(Wn),Jn=a(298),Kn=f.a.Content,Qn=f.a.Sider,Yn={fetchRecording:Ue};var $n,Xn,er,tr=Object(m.c)((function(e,t){return{call:Nt(e,parseInt(t.match.params.id))}}),Yn)((function(e){var t=e.call,a=e.match,c=e.fetchRecording,i=Object(n.useState)(a.params.id),l=Object(u.a)(i,1)[0],o=Object(n.useState)(!1),s=Object(u.a)(o,2),d=s[0],b=s[1],h=Object(n.useState)(),E=Object(u.a)(h,2),v=E[0],g=E[1],y=Object(n.useState)([]),j=Object(u.a)(y,2),w=j[0],k=j[1],C=Object(m.d)((function(e){var t;return null===(t=e.facilities.selected)||void 0===t?void 0:t.name}));Object(n.useEffect)((function(){t&&!t.recordingUrl&&c(t.id)}),[t,c]),Object(n.useEffect)((function(){(null===t||void 0===t?void 0:t.recordingUrl)&&g(t.recordingUrl),(null===t||void 0===t?void 0:t.messages)&&k(t.messages)}),[t,g]);var x=[{path:"logs",breadcrumbName:"Logs"},{path:"call",breadcrumbName:"Call #".concat(l)}];return t?r.a.createElement(f.a,null,r.a.createElement(Kn,{style:ae},r.a.createElement(Zn.a,{autoplay:!0,muted:!0,controls:!0,width:"100%",url:"/recording_demo.mp4"}),r.a.createElement(Pt.a,{ghost:!1,onBack:function(){return window.history.back()},title:"Call #".concat(l),subTitle:C,breadcrumb:{routes:x},extra:[r.a.createElement(O.a,{key:"download",download:!0,target:"_blank",icon:r.a.createElement(Tn.a,null),href:v},"Download"),r.a.createElement(O.a,{key:"info",onClick:function(){return console.log("add connection page")},icon:r.a.createElement(Jn.a,null)},"Connection")]},r.a.createElement(cn.b,{size:"small",column:3},r.a.createElement(cn.b.Item,{label:"Incarcerated Person"},we(t.connection.inmate)),r.a.createElement(cn.b.Item,{label:"Inmate ID"},t.connection.inmate.id),r.a.createElement(cn.b.Item,{label:"Visitor"},we(t.connection.contact)),r.a.createElement(cn.b.Item,{label:"Relationship"},t.connection.relationship),r.a.createElement(cn.b.Item,{label:"Date"},Object(pe.a)(t.scheduledStartTime,"HH:mm")),r.a.createElement(cn.b.Item,{label:"Start Time"},Object(pe.a)(t.scheduledStartTime,"HH:mm")),r.a.createElement(cn.b.Item,{label:"End Time"},Object(pe.a)(t.scheduledEndTime,"HH:mm")),r.a.createElement(cn.b.Item,{label:"Location"},"Under the stairs")))),r.a.createElement(Qn,{theme:"light",style:{height:"100vh",maxHeight:"100vh"},width:300,collapsible:!0,collapsed:d,onCollapse:function(e){return b(e)}},!d&&r.a.createElement("div",null,r.a.createElement(Pt.a,{title:"Chat"})," ",r.a.createElement("div",{style:ae},r.a.createElement(p.b,{direction:"vertical",style:{overflowY:"scroll",display:"flex",flexDirection:"column",height:"100%"}},w.map((function(e){return r.a.createElement(ua,{message:e})}))))))):r.a.createElement("div",null)}));!function(e){e.LiveCall="live",e.Contact="contact",e.ConnectionRequest="request",e.ApprovedConnectioo="connection",e.Inmate="inmate",e.Staff="staff",e.PastVisitation="record"}($n||($n={})),function(e){e.Small="small",e.Medium="medium",e.Large="large"}(Xn||(Xn={})),function(e){e.AcceptConnection="accept",e.FetchRecording="video"}(er||(er={}));var ar,nr={allowRead:"Can view",allowCalltimes:"Manage calltimes",allowApproval:"Approve connections",allowRestructure:"Reorganize facility",allowMonitor:"Monitor live calls"};!function(e){e[e.Sunday=0]="Sunday",e[e.Monday=1]="Monday",e[e.Tuesday=2]="Tuesday",e[e.Wednesday=3]="Wednesday",e[e.Thursday=4]="Thursday",e[e.Friday=5]="Friday",e[e.Saturday=6]="Saturday"}(ar||(ar={}));var rr=[{path:"/calendar",component:wa,label:"Page"},{path:"/requests",component:Ta,label:"Connection Requests"},{path:"/logs",component:qa,label:"Search for Visits"},{path:"/staff",component:Ka,label:"Staff"},{path:"/members",component:nn,label:"Inmates"},{path:"/members/:id",component:mn,label:"Incarcerated Individual"},{path:"/visitations",component:Ea,label:"Live Calls"},{path:"/settings",component:Gn,label:"Settings"},{path:"/call/:id",component:tr,label:"Past Call"},{path:"/",component:Rn,label:"Dashboard"}],cr=[ar.Sunday,ar.Monday,ar.Tuesday,ar.Wednesday,ar.Thursday,ar.Friday,ar.Saturday],ir=18e5,lr={1:24,2:12,4:12,6:8,8:6},or={1:80,2:80,4:40,6:40,8:40},sr=[{id:0,title:"Unallowed visitor",body:"All participants on the call must have  been registered and pre-approved ahead of time. The presence of unallowed visitors may lead to call termination."},{id:1,title:"Appropriate clothing",body:"All adult and minor visitors, including attorneys, must be fully dressed in appopriate, conventional clothing which is not unduly provocative, suggestive, or revealing and does not resemble offender attire or present adornments which could be used as a weapon."},{id:2,title:"Clothing exposure",body:"Any clothing worn on the top half of the body must have sleeves and not expose the cleavage line, back, midriff and/or underarm at any time while standing, sitting, and/or bending down."},{id:3,title:"Appropriate undergarments",body:"Appropriate undergarments are required, and will not be visible."},{id:4,title:"No sheer clothing",body:"Clothing which is sheer or transparent will not be permitted. Clothing that contains holes and/or rips will not be permitted."},{id:5,title:"Clothing no shorter than knee",body:"Outer garments worn on the bottom half of the body must be no shorter than the knee while standing."},{id:6,title:"Leggings no shorter than knee",body:"Leggings and jeggings may only be worn under outer garments that must be no shorter than the knee while standing."}],ur=function(e){return{type:"user/SET_SESSION",payload:e}},dr=function(e){return{type:"user/SET_SESSION_STATUS",payload:e}},mr={user:{id:-999,firstName:"",lastName:"",email:"",token:"",remember:""},status:"inactive",redirectUrl:"/"};function fr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:mr,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"user/SET_SESSION":return Object(q.a)(Object(q.a)({},e),{},{user:t.payload,status:"active"});case"user/LOGOUT":return sessionStorage.removeItem("token"),sessionStorage.removeItem("remember"),Object(q.a)(Object(q.a)({},e),{},{user:{id:-999,firstName:"",lastName:"",email:"",token:"",remember:""},status:"inactive",redirectUrl:"/"});case"user/SET_REDIRECT_URL":return Object(q.a)(Object(q.a)({},e),{},{redirectUrl:t.payload});case"user/SET_SESSION_STATUS":return Object(q.a)(Object(q.a)({},e),{},{status:t.payload});default:return e}}var pr,br=a(169),hr=a(483),Er=a(131),vr=Object(z.d)({name:"socket",initialState:{},reducers:{setSocket:function(e,t){return Object(q.a)(Object(q.a)({},e),{},{socket:t.payload})}}}),gr=(vr.actions,Object(Er.a)()),yr=(pr=gr,Object(V.c)({staff:Q.reducer,session:fr,inmates:ee.reducer,contacts:Fe.reducer,connections:Pe.reducer,calls:Ge.reducer,facilities:$e.reducer,router:Object(br.b)(pr),sockets:vr.reducer,nodes:tt.reducer,kiosks:rt.reducer})),Or=Object(z.a)({reducer:yr,middleware:function(e){return e().concat(Object(hr.a)(gr))}}),jr="".concat("https://connect-api-staging.ameelio.org/","api/");function wr(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:15e3;return Promise.race([fetch(e,Object(q.a)(Object(q.a)({},t),{},{mode:"cors"})),new Promise((function(e,t){return setTimeout((function(){return t(new Error("timeout"))}),a)}))])}function kr(e){return Cr.apply(this,arguments)}function Cr(){return(Cr=Object(s.a)(o.a.mark((function e(t){var a,n,r,c,i,l,s,u,d,m=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=m.length>1&&void 0!==m[1]?m[1]:{},r=!(m.length>2&&void 0!==m[2])||m[2],c=m.length>3&&void 0!==m[3]?m[3]:15e3,i=Or.getState(),l=Object(q.a)(Object(q.a)({},n),{},{headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(i.session.user.token)}}),s="".concat(jr).concat(r?"node/".concat(null===(a=i.facilities.selected)||void 0===a?void 0:a.nodeId):"").concat(t),e.next=8,wr(s,l,c);case 8:return u=e.sent,e.next=11,u.json();case 11:return d=e.sent,e.abrupt("return",d);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var xr=a(372),Sr=a.n(xr);function Ir(e){return Tr.apply(this,arguments)}function Tr(){return(Tr=Object(s.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=_()(t.data),Or.dispatch(ur(a)),localStorage.setItem("token",a.token),localStorage.setItem("remember",a.remember);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Nr(){return Dr.apply(this,arguments)}function Dr(){return(Dr=Object(s.a)(o.a.mark((function e(){var t,a,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=localStorage.getItem("remember")){e.next=4;break}throw Error("Cannot load token");case 4:return Or.dispatch(dr("loading")),e.next=7,wr(Sr.a.resolve(jr,"auth/login/remember"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({remember:t})});case 7:return a=e.sent,e.next=10,a.json();case 10:if(200===(n=e.sent).status){e.next=14;break}throw Or.dispatch(dr("inactive")),n;case 14:return e.next=16,Ir(n);case 16:e.next=21;break;case 18:throw e.prev=18,e.t0=e.catch(0),Error(e.t0);case 21:case"end":return e.stop()}}),e,null,[[0,18]])})))).apply(this,arguments)}function Ar(e){return Mr.apply(this,arguments)}function Mr(){return(Mr=Object(s.a)(o.a.mark((function e(t){var a,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Or.dispatch(dr("loading")),e.next=3,wr(Sr.a.resolve(jr,"auth/login"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:t.email,password:t.password})});case 3:return a=e.sent,e.next=6,a.json();case 6:if(200===(n=e.sent).status){e.next=10;break}throw Or.dispatch(dr("inactive")),n;case 10:return e.next=12,Ir(n);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Hr=a(937),Rr=a(938),Pr=f.a.Content,Lr=Object(m.c)((function(e){return{session:e.session}}));var Br=Lr((function(e){var t=e.session;if("active"===t.status)return Ae("login","Welcome back, ".concat(t.user.firstName,"!"),"success"),r.a.createElement(d.a,{to:t.redirectUrl});var a=function(){var e=Object(s.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Ae("login","Authenticating with credentials...","loading"),e.prev=1,e.next=4,Ar({email:t.email,password:t.password,remember:t.remember});case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),Ae("login","Invalid email or password","error");case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(Pr,{className:"d-flex flex-column"},r.a.createElement(p.b,{direction:"vertical",className:"m-auto"},r.a.createElement(b.a,{justify:"center"},r.a.createElement(F,{className:"login-logo"})),r.a.createElement(h.a,{className:"login-form-container"},r.a.createElement(b.a,{justify:"center"},r.a.createElement(E.a.Title,{level:3},"Log in to Ameelio")),r.a.createElement(v.a,{name:"basic",initialValues:{remember:!0},onFinish:a,onFinishFailed:function(e){Ae("login","Invalid email or password","error")},className:"login-form"},r.a.createElement(v.a.Item,{name:"email",rules:[{required:!0,message:"Email is required."}]},r.a.createElement(g.a,{prefix:r.a.createElement(Hr.a,{className:"site-form-item-icon"}),placeholder:"Email"})),r.a.createElement(v.a.Item,{name:"password",rules:[{required:!0,message:"Password is required."}]},r.a.createElement(g.a.Password,{prefix:r.a.createElement(Rr.a,{className:"site-form-item-icon"}),placeholder:"Password"})),r.a.createElement(v.a.Item,{name:"remember",valuePropName:"checked"},r.a.createElement(y.a,null,"Remember me")),r.a.createElement(v.a.Item,null,r.a.createElement(O.a,{type:"primary",htmlType:"submit",size:"large",block:!0,loading:"loading"===t.status},"Log In"))))))})),Fr=function(e){var t="";if(e.isAuthenticated||(t=e.authenticationPath),t){return n.createElement(d.b,Object.assign({},e,{component:function(){return n.createElement(d.a,{to:{pathname:t}})},render:void 0}))}return n.createElement(d.b,e)},qr=a(939),Vr=a(940),zr=a(941),Ur=a(942),_r=(a(895),f.a.Sider),Gr=Wt.a.SubMenu,Wr=function(e){var t=e.facility;return r.a.createElement(Ca.a,{size:"large",shape:"square",style:{backgroundColor:Se(t.name)}},t.name.split(" ").map((function(e){return e[0]})).join(""))};function Zr(e){var t=e.isLoggedIn,a=e.user,c=e.selected,i=e.facilities,l=e.select,o=e.logout,s=e.requestsCount,m=e.liveCallsCount,f=Object(n.useState)(!1),b=Object(u.a)(f,2),h=b[0],E=b[1],v=Object(d.f)();if(!t)return r.a.createElement("div",null);var g=r.a.createElement(Wt.a,null,r.a.createElement(Gr,{key:"sub2",title:"Switch Organization"},i.map((function(e){return r.a.createElement(Wt.a.Item,{key:e.nodeId,onClick:function(){return l(e)}},r.a.createElement(p.b,null,r.a.createElement(Wr,{facility:e}),r.a.createElement("span",null,e.name)))}))),r.a.createElement(Wt.a.Item,null,r.a.createElement("span",{onClick:function(){return o()}},"Log out")));return r.a.createElement(_r,{collapsible:!0,collapsed:h,onCollapse:function(e){return E(e)},width:216},r.a.createElement(Zt.a,{overlay:g},r.a.createElement(p.b,{align:"center",className:"menu-header"},r.a.createElement(Wr,{facility:c}),!h&&r.a.createElement(p.b,{direction:"vertical",size:0},r.a.createElement(p.b,{align:"center"},r.a.createElement("span",{className:"menu-header-facility"},c.name),r.a.createElement(Na.a,{style:{color:"white"}})),r.a.createElement("span",{className:"menu-header-name"},we(a))))),r.a.createElement(Wt.a,{theme:"dark",defaultSelectedKeys:["1"],mode:"inline"},r.a.createElement(Wt.a.Item,{key:"dash",icon:r.a.createElement(qr.a,null),onClick:function(){return v.push("/")}},"Dashboard"),r.a.createElement(Wt.a.Item,{key:"live",icon:r.a.createElement(Vr.a,null),onClick:function(){return v.push("/visitations")}},"Live Video Calls",r.a.createElement(ia.a,{count:m})),r.a.createElement(Wt.a.Item,{key:"requests",icon:r.a.createElement(Wa.a,null),onClick:function(){return v.push("/requests")}},"Approval Requests",r.a.createElement(ia.a,{count:s})),r.a.createElement(Wt.a.Item,{key:"search",icon:r.a.createElement(Wa.a,null),onClick:function(){return v.push("/logs")}},"Search for Visits"),r.a.createElement(Wt.a.Item,{key:"staff",icon:r.a.createElement(zr.a,null),onClick:function(){return v.push("/staff")}},"Staff"),r.a.createElement(Wt.a.Item,{key:"members",icon:r.a.createElement(zr.a,null),onClick:function(){return v.push("/members")}},"Incarcerated People"),r.a.createElement(Wt.a.Item,{key:"settings",icon:r.a.createElement(Ur.a,null),onClick:function(){return v.push("/settings")}},"Settings")))}var Jr=a(906),Kr={logout:function(){return{type:"user/LOGOUT"}},fetchFacilities:Ke,selectActiveFacility:Je,fetchContacts:Le,fetchStaff:W,fetchInmates:Y,fetchConnections:He,fetchNodes:Xe,fetchKiosks:nt,fetchCalls:ze,setRedirectUrl:function(e){return{type:"user/SET_REDIRECT_URL",payload:e}}},Qr=Object(m.c)((function(e){return{session:e.session,selected:e.facilities.selected,pathname:e.router.location.pathname,liveCallsCount:Dt(e).length,requestsCount:xt(e).length}}),Kr),Yr=function(){return r.a.createElement("div",{className:"d-flex vh-100 vw-100"},r.a.createElement(Gt.a,{size:"large",className:"m-auto",tip:"Loading workpace..."}))};var $r=Qr((function(e){var t=e.session,a=e.selected,c=e.pathname,i=e.liveCallsCount,l=e.requestsCount,p=e.selectActiveFacility,b=e.logout,h=e.fetchFacilities,E=e.fetchContacts,v=e.fetchInmates,g=e.fetchStaff,y=e.fetchConnections,O=e.fetchNodes,j=e.fetchKiosks,w=e.fetchCalls,k=e.setRedirectUrl,C=e.history,x=Object(n.useState)("active"===t.status),S=Object(u.a)(x,2),I=S[0],T=S[1],N=Object(n.useState)(!0),D=Object(u.a)(N,2),A=D[0],M=D[1];Object(n.useEffect)((function(){return T("active"===t.status)}),[t.status]);var H={isAuthenticated:I,authenticationPath:"/login"},R=Object(m.d)(yt);return Object(n.useEffect)((function(){localStorage.removeItem("debug"),Object(s.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Nr();case 3:return e.next=5,h();case 5:e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})))()}),[h]),Object(n.useEffect)((function(){I&&h()}),[I,h]),Object(n.useEffect)((function(){I||"/login"===c||k(c)}),[k,I,c]),Object(n.useEffect)((function(){a&&(M(!0),Object(s.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.allSettled([E(),g(),v(),y(),j(),O()]);case 2:w({startDate:Object(fe.a)(new Date).getTime(),endDate:Object(Jr.a)(new Date).getTime()});case 3:case"end":return e.stop()}}),e)})))().then((function(){return M(!1)})))}),[a,E,g,y,v,O,w,j]),r.a.createElement(br.a,{history:C},r.a.createElement(f.a,{style:{minHeight:"100vh"}},a&&r.a.createElement(Zr,{user:t.user,isLoggedIn:I,logout:b,selected:a,facilities:R,select:function(e){return p(e)},liveCallsCount:i,requestsCount:l}),r.a.createElement(f.a,null,A&&I||"loading"===t.status?r.a.createElement(Yr,null):r.a.createElement(d.d,null,r.a.createElement(d.b,{exact:!0,path:"/login",component:Br}),rr.map((function(e){return r.a.createElement(Fr,Object.assign({exact:!0},H,{path:e.path,component:e.component,key:e.label}))}))))))}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(m.a,{store:Or},r.a.createElement($r,{history:gr}))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[532,1,2]]]);
//# sourceMappingURL=main.7d1643c6.chunk.js.map